(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{1961:function(e,t,r){Promise.resolve().then(r.bind(r,1720))},1720:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(7437),n=r(2265),a=r(9376),i=r(2141),l=r(5865);function d(){let e=(0,a.useRouter)(),[t,r]=(0,n.useState)(null),[d,o]=(0,n.useState)([]),[c,x]=(0,n.useState)(!0),[u,m]=(0,n.useState)(""),[h,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{let{data:{session:t}}=await i.O.auth.getSession();if(!t){e.push("/auth");return}let{data:s}=await i.O.from("users").select("*").eq("id",t.user.id).single();if(!s){e.push("/onboarding");return}r(s);let{data:n}=await i.O.from("messages").select("*").eq("user_id",t.user.id).order("created_at",{ascending:!1});n&&o(n),x(!1)})()},[e]);let f=()=>{if(!t||!t.link_id)return;let e="".concat(window.location.origin,"/box?id=").concat(t.link_id);navigator.clipboard.writeText(e),m("링크가 복사되었습니다!"),setTimeout(()=>m(""),2e3)},g=async e=>{b(e),e.is_opened||(await i.O.from("messages").update({is_opened:!0}).eq("id",e.id),o(t=>t.map(t=>t.id===e.id?{...t,is_opened:!0}:t)))};return c?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})}):(0,s.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-green-50 py-10 px-4 overflow-hidden relative",children:[(0,s.jsx)(l.default,{}),(0,s.jsxs)("div",{className:"max-w-5xl mx-auto relative z-10",children:[(0,s.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center mb-10 gap-6",children:[(0,s.jsxs)("div",{className:"text-center md:text-left",children:[(0,s.jsx)("div",{className:"inline-block px-3 py-1 bg-red-100 text-red-600 rounded-full text-xs font-bold mb-2",children:"Happy Winter ❄️"}),(0,s.jsxs)("h1",{className:"text-3xl md:text-4xl font-black text-gray-900",children:[null==t?void 0:t.username,"님의 선물함 \uD83C\uDF81"]}),(0,s.jsxs)("p",{className:"text-gray-500 mt-2 font-medium",children:["지금까지 ",(0,s.jsx)("span",{className:"text-red-600 font-bold",children:d.length}),"개의 마음을 받았어요!"]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[(0,s.jsx)("button",{onClick:f,className:"flex-1 md:flex-none px-6 py-3 bg-white text-gray-700 border border-gray-200 rounded-xl font-bold hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm flex items-center justify-center gap-2",children:u?"✅ 복사 완료!":"\uD83D\uDD17 내 선물함 링크 복사"}),(0,s.jsx)("button",{onClick:async()=>{await i.O.auth.signOut(),e.push("/")},className:"px-6 py-3 text-gray-500 hover:text-red-600 font-medium transition-colors",children:"로그아웃"})]})]}),(0,s.jsx)("div",{className:"bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-12 shadow-2xl border border-white/60 min-h-[500px]",children:0===d.length?(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center py-32",children:[(0,s.jsx)("div",{className:"text-7xl mb-6 opacity-30 animate-bounce",children:"\uD83C\uDF81"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-700 mb-2",children:"아직 도착한 선물이 없어요"}),(0,s.jsx)("p",{className:"text-gray-500 mb-8",children:"친구들에게 링크를 공유해보세요!"}),(0,s.jsx)("button",{onClick:f,className:"px-8 py-4 bg-red-600 text-white font-bold rounded-2xl shadow-lg hover:bg-red-700 hover:-translate-y-1 transition-all",children:"링크 공유하고 선물 받기 \uD83D\uDCEE"})]}):(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:d.map((e,t)=>(0,s.jsxs)("div",{onClick:()=>g(e),className:"\n                                        aspect-square rounded-3xl p-4 md:p-6 shadow-lg relative overflow-hidden group cursor-pointer transition-all duration-300 flex flex-col items-center justify-center\n                                        ".concat(e.is_opened?"bg-white":"bg-red-50 border-2 border-red-100","\n                                        hover:-translate-y-2 hover:shadow-2xl\n                                    "),children:[(0,s.jsx)("span",{className:"text-6xl md:text-7xl mb-4 md:mb-5 transform group-hover:scale-110 transition-transform duration-300",children:e.is_opened?"\uD83E\uDDF8":"\uD83C\uDF81"}),(0,s.jsx)("span",{className:"text-sm md:text-base font-bold px-3 py-1 rounded-full truncate max-w-[90%] ".concat(e.is_opened?"bg-gray-100 text-gray-500":"bg-red-100 text-red-600"),children:e.sender_name||"익명"}),!e.is_opened&&(0,s.jsx)("div",{className:"absolute top-4 right-4 w-3 h-3 bg-red-600 rounded-full animate-ping"})]},e.id))})}),(0,s.jsxs)("div",{className:"mt-10 text-center",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"친구들에게 링크를 공유하고 더 많은 메시지를 받아보세요!"}),(0,s.jsxs)("div",{className:"inline-block bg-white px-4 py-2 rounded-lg border border-gray-200 text-gray-500 text-sm",children:[window.location.origin,"/box?id=",null==t?void 0:t.link_id]})]})]}),h&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>b(null),children:(0,s.jsxs)("div",{className:"bg-white rounded-3xl w-full max-w-lg p-8 shadow-2xl transform transition-all scale-100 relative translate-y-0",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("button",{onClick:()=>b(null),className:"absolute top-6 right-6 text-gray-300 hover:text-gray-500 transition-colors",children:(0,s.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsxs)("div",{className:"text-center mb-8 pt-4",children:[(0,s.jsx)("div",{className:"text-5xl mb-6",children:"\uD83C\uDF84"}),(0,s.jsxs)("h3",{className:"text-2xl font-bold text-gray-900 leading-tight",children:[(0,s.jsx)("span",{className:"text-red-600",children:h.sender_name||"익명"}),"님이 보낸",(0,s.jsx)("br",{}),"마음의 선물입니다"]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mt-3 font-medium",children:new Date(h.created_at).toLocaleString()})]}),h.emotion_analysis&&(0,s.jsxs)("div",{className:"mx-auto mb-6 bg-white border-2 border-dashed border-gray-300 p-4 rounded-lg w-full max-w-xs relative rotate-1 shadow-sm",children:[(0,s.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 bg-white px-2 text-xs font-bold text-gray-400 tracking-widest",children:"INGREDIENTS"}),(0,s.jsx)("h4",{className:"text-center font-bold text-gray-700 mb-3 border-b pb-2 text-sm",children:"선물 성분표 \uD83E\uDDFE"}),(0,s.jsx)("div",{className:"space-y-2",children:Object.entries(h.emotion_analysis).map(e=>{let[t,r]=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:t}),(0,s.jsx)("div",{className:"flex-1 mx-3 h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-red-400 rounded-full",style:{width:"".concat(r,"%")}})}),(0,s.jsxs)("span",{className:"font-mono font-bold text-gray-800",children:[r,"%"]})]},t)})}),(0,s.jsx)("div",{className:"mt-3 pt-2 border-t border-dashed border-gray-300 text-center text-xs text-gray-400 font-mono",children:"100% SINCERITY INCLUDED"})]}),(0,s.jsx)("div",{className:"bg-[#FFFDF5] p-8 rounded-2xl text-gray-700 leading-relaxed whitespace-pre-wrap max-h-[50vh] overflow-y-auto mb-8 text-lg border border-red-50 shadow-inner",children:h.content}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsx)("button",{onClick:()=>b(null),className:"flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200 transition-colors",children:"닫기"})})]})})]})}},5865:function(e,t,r){"use strict";r.d(t,{default:function(){return a}});var s=r(7437),n=r(2265);function a(){let e=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let t=e.current;if(!t)return;let r=t.getContext("2d");if(!r)return;let s=window.innerWidth,n=window.innerHeight;t.width=s,t.height=n;let a=[];for(let e=0;e<50;e++)a.push({x:Math.random()*s,y:Math.random()*n,radius:3*Math.random()+1,speed:1*Math.random()+.5,opacity:.5*Math.random()+.3});!function e(){r&&t&&(r.clearRect(0,0,t.width,t.height),r.fillStyle="white",a.forEach(e=>{r.beginPath(),r.arc(e.x,e.y,e.radius,0,2*Math.PI),r.fillStyle="rgba(255, 255, 255, ".concat(e.opacity,")"),r.fill(),e.y+=e.speed,e.x+=.5*Math.sin(e.y/50),e.y>t.height&&(e.y=-10,e.x=Math.random()*t.width)}),requestAnimationFrame(e))}();let i=()=>{t&&(t.width=window.innerWidth,t.height=window.innerHeight)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),(0,s.jsx)("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-50",style:{width:"100%",height:"100%"}})}},2141:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var s=r(338);let n="https://vlydnlmwwhofsksikaeh.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZseWRubG13d2hvZnNrc2lrYWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3ODQ0NzEsImV4cCI6MjA3ODM2MDQ3MX0.XA5pvZRRAVd5h3q1g4iJ0Muibadb1gIKbSBnuW9lu78";n&&a||console.warn("Supabase environment variables are not set");let i=(0,s.createBrowserClient)(n,a)},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[338,971,117,744],function(){return e(e.s=1961)}),_N_E=e.O()}]);