(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{1961:function(e,t,s){Promise.resolve().then(s.bind(s,1720))},1720:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),n=s(9376),l=s(2141),i=s(5865),o=s(3511);function d(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(null),[d,c]=(0,a.useState)([]),[x,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(""),[g,b]=(0,a.useState)(null),[f,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{localStorage.getItem("has_seen_guide")||p(!0)},[]),(0,a.useEffect)(()=>{(async()=>{let{data:{session:t}}=await l.O.auth.getSession();if(!t){e.push("/auth");return}let{data:r}=await l.O.from("users").select("*").eq("id",t.user.id).single();if(!r){e.push("/onboarding");return}s(r);let{data:a}=await l.O.from("messages").select("*").eq("user_id",t.user.id).order("created_at",{ascending:!1});a&&c(a),u(!1)})()},[e]);let w=()=>{if(!t||!t.link_id)return;let e="".concat(window.location.origin,"/box?id=").concat(t.link_id);navigator.clipboard.writeText(e),h("링크가 복사되었습니다!"),setTimeout(()=>h(""),2e3)},y=async e=>{b(e),e.is_opened||(await l.O.from("messages").update({is_opened:!0}).eq("id",e.id),c(t=>t.map(t=>t.id===e.id?{...t,is_opened:!0}:t)))};return x?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-green-50 py-10 px-4 overflow-hidden relative",children:[(0,r.jsx)(i.Z,{}),(0,r.jsxs)("div",{className:"max-w-5xl mx-auto relative z-10",children:[(0,r.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center mb-10 gap-6",children:[(0,r.jsxs)("div",{className:"text-center md:text-left",children:[(0,r.jsx)("div",{className:"inline-block px-3 py-1 bg-red-100 text-red-600 rounded-full text-xs font-bold mb-2",children:"Happy Winter ❄️"}),(0,r.jsxs)("h1",{className:"text-3xl md:text-4xl font-black text-gray-900",children:[null==t?void 0:t.username,"님의 선물함 \uD83C\uDF81"]}),(0,r.jsxs)("p",{className:"text-gray-500 mt-2 font-medium",children:["지금까지 ",(0,r.jsx)("span",{className:"text-red-600 font-bold",children:d.length}),"개의 마음을 받았어요!"]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[(0,r.jsx)("button",{onClick:w,className:"flex-1 md:flex-none px-6 py-3 bg-white text-gray-700 border border-gray-200 rounded-xl font-bold hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm flex items-center justify-center gap-2",children:m?"✅ 복사 완료!":"\uD83D\uDD17 내 선물함 링크 복사"}),(0,r.jsx)("button",{onClick:async()=>{await l.O.auth.signOut(),e.push("/")},className:"px-6 py-3 text-gray-500 hover:text-red-600 font-medium transition-colors",children:"로그아웃"})]})]}),(0,r.jsx)("div",{className:"bg-white/40 backdrop-blur-md rounded-[2.5rem] p-6 md:p-12 shadow-2xl border border-white/60 min-h-[500px]",children:0===d.length?(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center py-32",children:[(0,r.jsx)("div",{className:"text-7xl mb-6 opacity-30 animate-bounce",children:"\uD83C\uDF81"}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-700 mb-2",children:"아직 도착한 선물이 없어요"}),(0,r.jsx)("p",{className:"text-gray-500 mb-8",children:"친구들에게 링크를 공유해보세요!"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 w-full max-w-sm",children:[(0,r.jsx)("button",{onClick:w,className:"px-8 py-4 bg-red-600 text-white font-bold rounded-2xl shadow-lg hover:bg-red-700 hover:-translate-y-1 transition-all",children:"링크 공유하고 선물 받기 \uD83D\uDCEE"}),(0,r.jsx)("button",{onClick:()=>p(!0),className:"px-8 py-3 bg-white text-gray-600 font-bold rounded-2xl border border-gray-200 hover:bg-gray-50 transition-all text-sm",children:"❓ 어떻게 하는 건가요?"})]})]}):(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:d.map((e,t)=>(0,r.jsxs)("div",{onClick:()=>y(e),className:"\n                                            aspect-square rounded-3xl p-4 md:p-6 shadow-lg relative overflow-hidden group cursor-pointer transition-all duration-300 flex flex-col items-center justify-center\n                                            ".concat(e.is_opened?"bg-white":"bg-red-50 border-2 border-red-100","\n                                            hover:-translate-y-2 hover:shadow-2xl\n                                        "),children:[(0,r.jsx)("span",{className:"text-6xl md:text-7xl mb-4 md:mb-5 transform group-hover:scale-110 transition-transform duration-300",children:e.is_opened?"\uD83E\uDDF8":"\uD83C\uDF81"}),(0,r.jsx)("span",{className:"text-sm md:text-base font-bold px-3 py-1 rounded-full truncate max-w-[90%] ".concat(e.is_opened?"bg-gray-100 text-gray-500":"bg-red-100 text-red-600"),children:e.sender_name||"익명"}),!e.is_opened&&(0,r.jsx)("div",{className:"absolute top-4 right-4 w-3 h-3 bg-red-600 rounded-full animate-ping"})]},e.id))})}),(0,r.jsxs)("div",{className:"mt-10 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"친구들에게 링크를 공유하고 더 많은 메시지를 받아보세요!"}),(0,r.jsxs)("div",{className:"inline-block bg-white px-4 py-2 rounded-lg border border-gray-200 text-gray-500 text-sm",children:[window.location.origin,"/box?id=",null==t?void 0:t.link_id]})]})]}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>b(null),children:(0,r.jsxs)("div",{className:"bg-white rounded-3xl w-full max-w-lg p-8 shadow-2xl transform transition-all scale-100 relative translate-y-0",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:()=>b(null),className:"absolute top-6 right-6 text-gray-300 hover:text-gray-500 transition-colors",children:(0,r.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"text-center mb-8 pt-4",children:[(0,r.jsx)("div",{className:"text-5xl mb-6",children:"\uD83C\uDF84"}),(0,r.jsxs)("h3",{className:"text-2xl font-bold text-gray-900 leading-tight",children:[(0,r.jsx)("span",{className:"text-red-600",children:g.sender_name||"익명"}),"님이 보낸",(0,r.jsx)("br",{}),"마음의 선물입니다"]}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-3 font-medium",children:new Date(g.created_at).toLocaleString()})]}),g.emotion_analysis&&(0,r.jsxs)("div",{className:"mx-auto mb-6 bg-white border-2 border-dashed border-gray-300 p-4 rounded-lg w-full max-w-xs relative rotate-1 shadow-sm",children:[(0,r.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 bg-white px-2 text-xs font-bold text-gray-400 tracking-widest",children:"INGREDIENTS"}),(0,r.jsx)("h4",{className:"text-center font-bold text-gray-700 mb-3 border-b pb-2 text-sm",children:"선물 성분표 \uD83E\uDDFE"}),(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(g.emotion_analysis).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"font-medium text-gray-600",children:t}),(0,r.jsx)("div",{className:"flex-1 mx-3 h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-red-400 rounded-full",style:{width:"".concat(s,"%")}})}),(0,r.jsxs)("span",{className:"font-mono font-bold text-gray-800",children:[s,"%"]})]},t)})}),(0,r.jsx)("div",{className:"mt-3 pt-2 border-t border-dashed border-gray-300 text-center text-xs text-gray-400 font-mono",children:"100% SINCERITY INCLUDED"})]}),(0,r.jsx)("div",{className:"bg-[#FFFDF5] p-8 rounded-2xl text-gray-700 leading-relaxed whitespace-pre-wrap max-h-[50vh] overflow-y-auto mb-8 text-lg border border-red-50 shadow-inner",children:g.content}),(0,r.jsx)("div",{className:"flex gap-3",children:(0,r.jsx)("button",{onClick:()=>b(null),className:"flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200 transition-colors",children:"닫기"})})]})})]}),(0,r.jsx)(o.Z,{isOpen:f,onClose:()=>p(!1)})]})}},3511:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(7437),a=s(2265);function n(e){let{isOpen:t,onClose:s}=e,[n,l]=(0,a.useState)(0),i=[{emoji:"\uD83C\uDF81",title:"3초 만에 선물함 만들기",desc:"복잡한 절차는 없어요! 로그인 한 번이면\n나만의 특별한 선물함이 즉시 만들어집니다.",color:"bg-red-50 text-red-600"},{emoji:"\uD83D\uDD17",title:"링크 복사해서 자랑하기",desc:"내 선물함 주소를 복사해서\n인스타그램 스토리나 카톡 프로필에 올려주세요.\n'나한테도 써줘!'라고 적어보면 어떨까요?",color:"bg-green-50 text-green-600"},{emoji:"\uD83D\uDC8C",title:"익명 편지 열어보기",desc:"친구들의 속마음이 익명으로 도착해요.\n누가 보냈을지 상상하며 하나씩 열어보세요.\n도착한 마음들은 평생 간직할 수 있어요.",color:"bg-yellow-50 text-yellow-600"}];(0,a.useEffect)(()=>{t&&l(0)},[t]);let o=()=>{localStorage.setItem("has_seen_guide","true"),s()};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:o,children:(0,r.jsxs)("div",{className:"bg-white rounded-3xl w-full max-w-sm p-8 shadow-2xl relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{onClick:o,className:"absolute top-4 right-4 text-gray-300 hover:text-gray-500 transition-colors p-2",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"text-center mt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-8",children:"FromDear 200% 즐기기 ❄️"}),(0,r.jsx)("div",{className:"relative min-h-[220px]",children:i.map((e,t)=>(0,r.jsxs)("div",{className:"absolute inset-0 transition-all duration-500 transform ".concat(t===n?"opacity-100 translate-x-0 scale-100":t<n?"opacity-0 -translate-x-full scale-90":"opacity-0 translate-x-full scale-90"),children:[(0,r.jsx)("div",{className:"w-24 h-24 mx-auto ".concat(e.color," rounded-full flex items-center justify-center text-5xl mb-6 shadow-sm"),children:e.emoji}),(0,r.jsx)("h4",{className:"text-lg font-bold text-gray-800 mb-3",children:e.title}),(0,r.jsx)("p",{className:"text-gray-500 leading-relaxed whitespace-pre-wrap",children:e.desc})]},t))}),(0,r.jsx)("div",{className:"flex justify-center gap-2 mb-8 mt-10",children:i.map((e,t)=>(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(t===n?"w-8 bg-red-500":"w-2 bg-gray-200")},t))}),(0,r.jsx)("button",{onClick:()=>{n<i.length-1?l(n+1):o()},className:"w-full py-4 bg-gray-900 text-white font-bold rounded-2xl hover:bg-black transition-all shadow-lg active:scale-95",children:n<i.length-1?"다음 >":"시작하기!"})]})]})}):null}},5865:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(7437),a=s(2265);function n(){let e=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let s=t.getContext("2d");if(!s)return;let r=window.innerWidth,a=window.innerHeight;t.width=r,t.height=a;let n=[];for(let e=0;e<50;e++)n.push({x:Math.random()*r,y:Math.random()*a,radius:3*Math.random()+1,speed:1*Math.random()+.5,opacity:.5*Math.random()+.3});!function e(){s&&t&&(s.clearRect(0,0,t.width,t.height),s.fillStyle="white",n.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,e.radius,0,2*Math.PI),s.fillStyle="rgba(255, 255, 255, ".concat(e.opacity,")"),s.fill(),e.y+=e.speed,e.x+=.5*Math.sin(e.y/50),e.y>t.height&&(e.y=-10,e.x=Math.random()*t.width)}),requestAnimationFrame(e))}();let l=()=>{t&&(t.width=window.innerWidth,t.height=window.innerHeight)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),(0,r.jsx)("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-50",style:{width:"100%",height:"100%"}})}},2141:function(e,t,s){"use strict";s.d(t,{O:function(){return l}});var r=s(338);let a="https://vlydnlmwwhofsksikaeh.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZseWRubG13d2hvZnNrc2lrYWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3ODQ0NzEsImV4cCI6MjA3ODM2MDQ3MX0.XA5pvZRRAVd5h3q1g4iJ0Muibadb1gIKbSBnuW9lu78";a&&n||console.warn("Supabase environment variables are not set");let l=(0,r.createBrowserClient)(a,n)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[338,971,117,744],function(){return e(e.s=1961)}),_N_E=e.O()}]);